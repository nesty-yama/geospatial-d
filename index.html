<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="content-language" content="ja">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <meta name="format-detection" content="telephone=no">
  <title>チームD制作物</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
  <link rel="stylesheet" href="index.css">
  
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>

  <script>
    let longLat = 36.11517610603418; // 緯度
    let longLon = 139.10972180053537; // 経度
    let intZoom = 14; // ズームレベル
    let mapLayer = null;

    // オープンデータ(json)
    let openDataList = [{
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [ 139.739538, 35.686898 ]
      }
    }];

    // マップを表示
    let map = L.map("map");
    map.setView([longLat, longLon], intZoom);

    mapLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
      {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }
    );
    mapLayer.addTo(map);

    //GeoJSON形式のマーカーをマップに追加
    // 単身高齢者情報
/*
    $.getJSON("SupportList.geojson", function (data) {
      L.geoJson(data).addTo(map);
      L.geoJson(data).bindPopup(function (layer) {
         return layer.feature.properties.Name;
        }).addTo(map)      
    });
/**/
    let SupportListMarkerOptions = {
     radius: 10,
     fillColor: "#ff0000",
     color: "#000",
     weight: 1,
     opacity: 1,
     fillOpacity: 0.8
    };

    let support_point;
　　 　 $.getJSON("SupportList.geojson", function (data) {
        support_point = L.geoJson(data,{
            pointToLayer: function (feature,cordinate) {
               return L.circleMarker(cordinate,SupportListMarkerOptions)},
            onEachFeature: function(feature,layer){
              let name = feature.properties.Name;
              layer.bindPopup(name);
            }     
        }).addTo(map)   
    });
/**/    
        
    //長瀞町の道路
   var RoadLineStyle={
		"color": "#666666",
		"weight": 5,
		"opacity": 1.0
//		"lineCap": "butt",
//		"lineJoin": "square",
//		"dashArray": "5 1",
//		"dashOffset": 1,
	}
   
 　 $.getJSON("SAITAMA_Nagatoro_Road.geojson", function (data) {
       L.geoJSON(data, {style: RoadLineStyle}).addTo(map);
   });
	  
    //河川
   var RiverLineStyle={
		"color": "#00FFFF",
		"weight": 3,
		"opacity": 1.0
//		"lineCap": "butt",
//		"lineJoin": "square",
//		"dashArray": "5 1",
//		"dashOffset": 1,
	}	  
 　 $.getJSON("SAITAMA_River.geojson", function (data) {
       L.geoJSON(data, {style: RiverLineStyle}).addTo(map);;
    });
  
    //緊急輸送道路
   var EmergencyRoadLineStyle={
		"color": "#FF00FF",
		"weight": 5,
		"opacity": 0.9
//		"lineCap": "butt",
//		"lineJoin": "square",
//		"dashArray": "5 1",
//		"dashOffset": 1,
	}	  
 　 $.getJSON("SAITAMA_EmergencyRoad.geojson", function (data) {
       L.geoJSON(data, {style: EmergencyRoadLineStyle}).addTo(map);
    });

    //避難施設
    let ShelterMarkerOptions = {
     radius: 8,
     fillColor: "#00ff00",
     color: "#000",
     weight: 1,
     opacity: 1,
     fillOpacity: 0.8
    };
    let shelter_point;
  　 $.getJSON("SAITAMA_Shelter.geojson", function (data) {
        //features配列から長瀞の緯度に相当する行だけを残した配列を作ってそれをfeatures配列に上書きする。
        data.features = data.features.filter((row) => {
          return (row.properties.緯度 > 31.07 && row.properties.緯度 < 31.15);
        })
//      if(data.features.properties.緯度 > 31.07 && data.features.properties.緯度 < 31.15){
        shelter_point = L.geoJson(data,{
            pointToLayer: function (feature,cordinate) {
               return L.circleMarker(cordinate,ShelterMarkerOptions)},
            onEachFeature: function(feature,layer){
              let name = feature.properties.P20_002;
              layer.bindPopup(name);
            }     
        }).addTo(map) 
//      }
    });

    //土砂災害警戒区域
　　　　　　　var LandslideLineStyle={
		"color": "#FF0000",
		"weight": 1,
		"opacity": 0.9
//		"lineCap": "butt",
//		"lineJoin": "square",
//		"dashArray": "5 1",
//		"dashOffset": 1,
	}
 　 $.getJSON("A33-20_11Polygon.geojson", function (data) {
       L.geoJSON(data, {style: LandslideLineStyle}).addTo(map);
    });
  
    //スケールの表示
    L.control.scale({imperial: false}).addTo(map);　 
  
  
    //GeoJSON形式のマーカーをマップに追加
    //L.geoJson(openDataList).addTo(map);
    //草加市役所にピンを追加した。
    //L.marker([35.82616444426248, 139.80728455224562], { title: "草加市役所の吹き出し",draggable:true }).addTo(map);
  </script>
</body>
</html>
